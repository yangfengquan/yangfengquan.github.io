<!DOCTYPE html>
<html>

  <head>
    <script src="./js/docx/docx.umd.js"></script>
    <script src="./js/docx/FileSaver.js"></script>
  </head>

  <body>

    <h1>DOCX browser Word document generation</h1>

    <button type="button" onclick="generate()">Click to generate document</button>

    <script>
      function generate() {
        const doc = new docx.Document({
            creator: window.location.hostname,
            title: "Report",
            description: "yangshu.gitee.io",
            styles: {
            paragraphStyles: [
                {
                    id: "Heading1",
                    name: "Heading 1",
                    basedOn: "Normal",
                    next: "Normal",
                    quickFormat: true,
                    run: {
                        size: 28,
                        bold: true,
                        italics: true,
                    },
                    paragraph: {
                        spacing: {
                            after: 120,
                        },
                    },
                },
                {
                    id: "Heading2",
                    name: "Heading 2",
                    basedOn: "Normal",
                    next: "Normal",
                    quickFormat: true,
                    run: {
                        size: 26,
                        bold: true,
                        underline: {
                            type: docx.UnderlineType.DOUBLE,
                            color: "FF0000",
                        },
                    },
                    paragraph: {
                        spacing: {
                            before: 240,
                            after: 120,
                        },
                    },
                },
                {
                    id: "content",
                    name: "content",
                    basedOn: "Normal",
                    next: "Normal",
                    run: {
                        size: 13 * 2,
                        font: "宋体"
                    }
                },
                {
                    id: "aside",
                    name: "Aside",
                    basedOn: "Normal",
                    next: "Normal",
                    run: {
                        color: "999999",
                        italics: true,
                    },
                    paragraph: {
                        indent: {
                            left: 720,
                        },
                        spacing: {
                            line: 276,
                        },
                    },
                },
                {
                    id: "wellSpaced",
                    name: "Well Spaced",
                    basedOn: "Normal",
                    quickFormat: true,
                    paragraph: {
                        spacing: { line: 276, before: 20 * 72 * 0.1, after: 20 * 72 * 0.05 },
                    },
                },
                {
                    id: "ListParagraph",
                    name: "List Paragraph",
                    basedOn: "Normal",
                    quickFormat: true,
                },
            ],
        },
        numbering: {
            config: [
                {
                    reference: "my-crazy-numbering",
                    levels: [
                        {
                            level: 0,
                            format: docx.LevelFormat.DECIMAL,//"lowerLetter",
                            text: "%1.",
                            alignment: docx.AlignmentType.LEFT,
                        },
                        {
                            level: 1,
                            format: docx.LevelFormat.DECIMAL,//"lowerLetter",
                            text: "%1)",
                            alignment: docx.AlignmentType.LEFT,
                            style: {
                                paragraph: {
                                    indent: { left: 460 },
                                },
                            },
                        },
                    ],
                },
            ],
        },
            sections: [{
                header: {
                    default: new docx.Header({
                        children: [new docx.Paragraph("Header text")],
                    })
                },
                footer: {
                    default: new docx.Footer({
                        children: [new docx.Paragraph("Footer Text")],
                    })
                },
                children: [
                    new docx.Paragraph({
                        text: "Head 2",
                        heading: docx.HeadingLevel.TITLE,
                        alignment: docx.AlignmentType.CENTER,
                    }),
                    new docx.Paragraph({
                        text: "Section",
                        heading: docx.HeadingLevel.HEADING_1,
                        numbering: {
                            reference: "my-crazy-numbering",
                            level: 0,
                        }
                    }),
                    new docx.Paragraph({
                        style: "content",
                        children: [
                            new docx.TextRun({
                                text: "压力",
                            }),
                            new docx.TextRun({
                                text: "\t1",
                                
                            }),
                            new docx.TextRun({
                                text: " MPa",
                            }),
                        ]
                    }),
                ]
            }],
            
        });

        docx.Packer.toBlob(doc).then(blob => {
          console.log(blob);
          saveAs(blob, "example.docx");
          console.log("Document created successfully");
        });
      }
    </script>

  </body>

</html>

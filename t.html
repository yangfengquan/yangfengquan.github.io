<!DOCTYPE html>
<html>

  <head>
    <script src="./docx/index.umd.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.8/FileSaver.js"></script>
  </head>

  <body>

    <h1>DOCX browser Word document generation</h1>

    <button type="button" onclick="generate()">Click to generate document</button>

    <script>
      function generate() {
        const doc = new Document({
    sections: [
        {
            children: [new docx.Paragraph("Hello World")],
        },
        {
            properties: {
                page: {
                    pageNumbers: {
                        start: 1,
                        formatType: docx.NumberFormat.DECIMAL,
                    },
                },
            },
            headers: {
                default: new docx.Header({
                    children: [new docx.Paragraph("First Default Header on another page")],
                }),
            },
            footers: {
                default: new docx.Footer({
                    children: [new docx.Paragraph("Footer on another page")],
                }),
            },

            children: [new docx.Paragraph("hello")],
        },
        {
            properties: {
                page: {
                    size: {
                        orientation: docx.PageOrientation.LANDSCAPE,
                    },
                    pageNumbers: {
                        start: 1,
                        formatType: docx.NumberFormat.DECIMAL,
                    },
                },
            },
            headers: {
                default: new docx.Header({
                    children: [new docx.Paragraph("Second Default Header on another page")],
                }),
            },
            footers: {
                default: new docx.Footer({
                    children: [new docx.Paragraph("Footer on another page")],
                }),
            },
            children: [new docx.Paragraph("hello in landscape")],
        },
        {
            properties: {
                page: {
                    size: {
                        orientation: docx.PageOrientation.PORTRAIT,
                    },
                },
            },
            headers: {
                default: new docx.Header({
                    children: [
                        new docx.Paragraph({
                            children: [
                                new docx.TextRun({
                                    children: ["Page number: ", docx.PageNumber.CURRENT],
                                }),
                            ],
                        }),
                    ],
                }),
            },

            children: [new docx.Paragraph("Page number in the header must be 2, because it continues from the previous section.")],
        },
        {
            properties: {
                page: {
                    size: {
                        orientation: docx.PageOrientation.PORTRAIT,
                    },
                    pageNumbers: {
                        formatType: docx.NumberFormat.UPPER_ROMAN,
                    },
                },
            },
            headers: {
                default: new docx.Header({
                    children: [
                        new docx.Paragraph({
                            children: [
                                new docx.TextRun({
                                    children: ["Page number: ", docx.PageNumber.CURRENT],
                                }),
                            ],
                        }),
                    ],
                }),
            },
            children: [
                new docx.Paragraph(
                    "Page number in the header must be III, because it continues from the previous section, but is defined as upper roman.",
                ),
            ],
        },
        {
            properties: {
                page: {
                    size: {
                        orientation: docx.PageOrientation.PORTRAIT,
                    },
                    pageNumbers: {
                        start: 25,
                        formatType: docx.NumberFormat.DECIMAL,
                    },
                },
            },
            headers: {
                default: new docx.Header({
                    children: [
                        new docx.Paragraph({
                            children: [
                                new docx.TextRun({
                                    children: ["Page number: ", docx.PageNumber.CURRENT],
                                }),
                            ],
                        }),
                    ],
                }),
            },
            // children: [
            //     new docx.Pdocx.Paragraph(
            //         "Page number in the header must be 25, because it is defined to start at 25 and to be decimal in this section.",
            //     ),
            // ],
        },
    ],
});

        docx.Packer.toBlob(doc).then(blob => {
          console.log(blob);
          saveAs(blob, "example.docx");
          console.log("Document created successfully");
        });
      }

    </script>

  </body>

</html>
